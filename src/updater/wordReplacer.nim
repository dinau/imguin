# This list has been maintained by hand. (-:
# by audin 2023/04

import pegs,os,strutils

let replacedWords = @[
                     #"are", # Ignore repalcing this word since it breaks reserve words.
                     #"when",
                     #"size",
                     "histogram",
                     "legend",
                     "hilight",
                     "sub",
                     "date",
                     "fmt",
                     "no",
                     "type",
                     "flags",
                     "cancel",
                     "keep",
                     "pad",
                     "pre",
                     "escape",
                     "try",
                     "read",
                     "dpi",
                     "custom",
                     "clip",
                     "repeat",
                     "display",
                     "uint8",
                     "pick",
                     "alpha",
                     "hdr",
                     "toggle",
                     "alive",
                     "section",
                     "out",
                     "grow",
                     "move",
                     "pass",
                     "thru",
                     "over",
                     "central",
                     "arrow",
                     "page",
                     "ctrl",
                     "halt",
                     "delete",
                     "dont",
                     "mix",
                     "value",
                     "bullet",
                     "front",
                     "coration",
                     "jump",
                     "back",
                     "large",
                     "regular",
                     "here",
                     "full",
                     "leaf",
                     "deliv",
                     "rect",
                     "click",
                     "appear",
                     "task",
                     "top",
                     "most",
                     "merge",
                     "clear",
                     "mini",
                     "can",
                     "other",
                     "own",
                     "bar",
                     "icon",
                     "hide",
                     "label",
                     "reorder",
                     "sizecall",
                     "context",
                     "last",
                     "render",
                     "isenable",
                     "isvisible",
                     "issorted",
                     "accept",
                     "before",
                     "disable",
                     "only",
                     "data",
                     "peek",
                     "extern",
                     "source",
                     "unfocused",
                     "indent",
                     "vertical",
                     "overwrite",
                     "override",
                     "level",
                     "shrink",
                     "temp",
                     "storage",
                     "blocked",
                     "delay",
                     "split",
                     "state",
                     "target",
                     "host",
                     "because",
                     "single",
                     "hidden",
                     "input",
                     "nav",
                     "stick",
                     "count",
                     "slow",
                     "tweak",
                     "fast",
                     "right",
                     "left",
                     "prev",
                     "scale",
                     "font",
                     "platform",
                     "text",
                     "treenode",
                     "popup",
                     "select",
                     "combo",
                     "call",
                     "height",
                     "tab",
                     "fit",
                     "border",
                     "resiz",
                     "column",
                     "focus",
                     "hover",
                     "doc",
                     "drag",
                     "drop",
                     "dir",
                     "cursor",
                     "sort",
                     "key",
                     "game",
                     "mouse",
                     "button",
                     "style",
                     "edit",
                     "preview",
                     "view",
                     "ptror",
                     "avail",
                     "index",
                     "routing",
                     "next",
                     "slider",
                     "request",
                     "port",
                     "private",
                     "item",
                     "status",
                     "multi",
                     "onrel",
                     "pressedon",
                     "child",
                     "child",
                     "span",
                     "width",
                     "setting",
                     "always",
                     "poli",
                     "default",
                     "mask",
                     "with",
                     "down",
                     "unsave",
                     "save",
                     "close",
                     "middle",
                     "list",
                     "scroll",
                     "tool",
                     "trail",
                     "push",
                     "hiera",
                     "root",
                     "frame",
                     "horiz",
                     "chars",
                     "case",
                     "upper",
                     "enter",
                     "true",
                     "auto",
                     "hexa",
                     "modal",
                     "round",
                     "align",
                     "release",
                     "sizing",
                     "fixed",
                     "stretch",
                     "inner",
                     "padding",
                     "spacing",
                     "active",
                     "activate",
                     "debug",
                     "backend",
                     "config",
                     "enabled",
                     "enable",
                     "visible",
                     "descend",
                     "ascend",
                     "prefer",
                     "sepa",
                     "grip",
                     "menu",
                     "grab",
                     "header",
                     "route",
                     "lock",
                     "until",
                     "event",
                     "wheel",
                     "once",
                     "upon",
                     "plot",
                     "axis",
                     "log",
                     "loc",
                     "entry",
                     "mod",
                     "shift",
                     "error",
                     "layout",
                     "stack",
                     "free",
                     "group",
                     "payload",
                     "metric",
                     "all",
                     "set",
                     "ope",
                     "col",
                     "and",
                     "any",
                     "sup",
                     "old",
                     "mem",
                     "cond",
                     "flat",
                     "float",
                     "double",
                     "win",
                     "has",
                     "bg ",
                     "up ",
                     "id ",
                     "s8",
                     "s16",
                     "s32",
                     "s64",
                     "u8",
                     "u16",
                     "u32",
                     "u64",
                    ]

var replaceList:seq[(string,string)]
for word in replacedWords:
   replaceList.add (word,word.capitalizeAscii())

if paramCount() == 0: quit 1
let fname = os.commandLineParams()[0]
var strOut:string

for line in readFile(fname).split("\n"):
  if (line =~ peg"\s+ ('Imgui' / 'Implot') @\s+'='\s+\d+($ / .+)"):
    let s1 = line.replace("Imgui","ImGui_")
    let s2 = s1.replace("Implot","ImPlot_")
    let s3 = s2.replace("flags","flags_")
    strOut.add s3.multiReplace(replaceList) & "\n"
  else:
    strOut.add line & "\n"

writefile(fname,strOut)

